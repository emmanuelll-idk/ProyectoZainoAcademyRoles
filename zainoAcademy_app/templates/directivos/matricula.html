<!-- 
Nombre del archivo: matricula.html 
Descripción: Este archivo es el formulario de la creacion de matricula
Autor: David Santiago Alfonso Guzman
Fecha de creación: 2025-04-18
Última modificación: 2025-08-27
-->

{% extends 'base_directivos.html' %}
{% load static %}
{% block page_title %}Matrícula{% endblock %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/directivos/maticulaStyles.css' %}">

<div class="action-buttons">
    <a href="{% url 'crear_matricula' %}" class="btn {% if request.path == '/matricula/crear/' %}btn-primary{% else %}btn-secondary{% endif %}">Crear</a>
    <a href="{% url 'lista_matriculas' %}" class="btn {% if request.path == '/matricula/listar/' %}btn-primary{% else %}btn-secondary{% endif %}">Consultar</a>
</div>

<!-- Mostrar mensajes de Django -->
{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<!-- Mostrar errores del formulario -->
{% if form.errors %}
<div class="alert alert-danger">
    <h4>Errores en el formulario:</h4>
    {% for field in form %}
        {% for error in field.errors %}
            <p><strong>{{ field.label }}:</strong> {{ error }}</p>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <p>{{ error }}</p>
    {% endfor %}
</div>
{% endif %}

<form method="post" enctype="multipart/form-data" class="form-layout">
    {% csrf_token %}

    <div class="column">
        <div class="form-group">
            {{ form.Estudiantes_Est.label_tag }}
            {{ form.Estudiantes_Est }}
        </div>
        <!-- REMOVIDO: Campo de fecha de matrícula -->
        <div class="form-group">
            {{ form.Mat_estado.label_tag }}
            {{ form.Mat_estado }}
        </div>
        <div class="form-group">
            {{ form.Mat_nivel.label_tag }}
            {{ form.Mat_nivel }}
        </div>
        <div class="form-group">
            {{ form.Mat_metodo_pago.label_tag }}
            {{ form.Mat_metodo_pago }}
        </div>
    </div>

    <div class="column">
        <div class="form-group">
            {{ form.Mat_valor.label_tag }}
            {{ form.Mat_valor }}
        </div>
        <div class="form-group">
            {{ form.Mat_fecha_pago.label_tag }}
            {{ form.Mat_fecha_pago }}
        </div>
        <div class="form-group">
            {{ form.Mat_comprobante.label_tag }}
            <div class="file-upload">
                <label for="id_Mat_comprobante" class="custom-file-upload">
                    Subir comprobante
                </label>
                {{ form.Mat_comprobante }}
                <span id="file-chosen">Ningún archivo seleccionado</span>
            </div>
        </div>
    </div>

    <button type="submit" class="submit-button">Registrar Matrícula</button>
</form>

<!-- JS para adjuntar los archivos de matriculas -->
<script>
const inputFile = document.getElementById("id_Mat_comprobante");
const fileChosen = document.getElementById("file-chosen");

if (inputFile) {
    inputFile.addEventListener("change", function(){
        fileChosen.textContent = this.files[0] ? this.files[0].name : "Ningún archivo seleccionado";
    });
}
</script>

{% endblock %}