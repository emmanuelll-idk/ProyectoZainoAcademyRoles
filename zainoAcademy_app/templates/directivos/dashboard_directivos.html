<!-- 
Nombre del archivo: editar_curso.html 
Descripción: Este archivo es un fomrulario de editra los cursos ya creados y de la lista de los estudiantes disponibles y ya guardados previamente
Autor: David Santiago Alfonso Guzman
Fecha de creación: 2025-04-18 
Última modificación: 2025-09-17
-->



<!DOCTYPE html>

{% load static %}
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Directivos</title>
<link rel="stylesheet" href="{% static 'css/directivos/dashboard_directivosStyles.css' %}">
<link href="https://fonts.googleapis.com/css?family=Comfortaa:700|Varela:400&display=swap" rel="stylesheet" />
<link rel="icon" type="image/vnd.icon" href="{% static 'images/favicon/Favicon.png' %}">
</head>
<body>
<div class="dashboard-container">
    <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
            <a href="{% url 'dashboard_directivo' %}">
                <img src="{% static 'images/acudientes/Favicon.png' %}" alt="Logo Libro"/>
            </a>
            <a href="{% url 'dashboard_directivo' %}">
                <img src="{% static 'images/acudientes/LogoNormal-removebg-preview.png' %}" alt="Logo Zaino Academy" />
            </a>
            </div>

            <nav>
                <ul class="nav-list">
                    <li><a href="{% url 'dashboard_directivo' %}" class="nav-item">
                        <img src="{% static 'images/acudientes/inicio.png' %}" class="nav-icon" alt="Inicio"> Inicio
                    </a></li>

                    <li><a href="{% url 'crear_usuario' %}" class="nav-item">
                        <img src="{% static 'images/directivos/LogoUsuario.png' %}" class="nav-icon" alt="Nuevo Usuario"> Nuevo Usuario
                    </a></li>

                    <li><a href="{% url 'crear_matricula' %}" class="nav-item">
                        <img src="{% static 'images/directivos/LogoLibro.png' %}" class="nav-icon" alt="Matricula"> Matricula
                    </a></li>

                    <li><a href="{% url 'crear_curso' %}" class="nav-item">
                        <img src="{% static 'images/directivos/LogoCurso.png' %}" class="nav-icon" alt="Curso"> Curso
                    </a></li>
                    
                    <li><a href="{% url 'crear_materia' %}" class="nav-item">
                        <img src="{% static 'images/directivos/LogoLibro.png' %}" class="nav-icon" alt="Materia"> Materia
                    </a></li>
                    
                    <li><a href="{% url 'periodo_directivos' %}" class="nav-item">
                        <img src="{% static 'images/directivos/LogoLibro.png' %}" class="nav-icon" alt="Asignacion"> Asignacion
                    </a></li>
                </ul>
            </nav>
            
            <!-- Botón de cerrar sesión -->
            <div class="logout-container">
                <form method="POST" action="{% url 'login' %}">
                    {% csrf_token %}
                    <button type="button" class="logout-btn" onclick="openModal()">Cerrar sesión</button>
                </form>
            </div>
        </aside>

    <!-- Contenido del Dashboard -->
    <main class="main-content">
        <header class="page-header">
            <div class="header-icons">
                <!-- Notificaciones -->
                
                <!-- Nombre -->
                <span class="user-name">{{ usuario.Us_nombre }}</span>
                
                <!-- Avatar / Perfil -->
                    <a href="{% url 'ver_perfil_directivos' %}">
                        {% if usuario.foto_perfil_usuario %}
                            <img src="{{ usuario.foto_perfil_usuario.url }}" class="user-avatar" alt="Perfil">
                        {% else %}
                            <img src="{% static 'images/acudientes/perfil.png' %}" class="user-avatar" alt="Perfil">
                        {% endif %}
                    </a>
            </div>

            <button class="hamburger" onclick="toggleMenu()">☰</button>
                
            <div id="dropdown-menu" class="dropdown-menu">
                    <a href="{% url 'dashboard_directivos' %}">Inicio</a>
                    <a href="{% url 'crear_usuario' %}">Nuevo Usuario</a>
                    <a href="{% url 'crear_matricula' %}">Matrícula</a>
                    <a href="{% url 'crear_curso' %}">Curso</a>
                    <a href="{% url 'crear_materia' %}">Materia</a>
                    <a href="{% url 'periodo_directivos' %}">Asignación</a>
                    <form method="POST" action="{% url 'login' %}">
                        {% csrf_token %}
                        <button type="button" class="dropdown-logout-btn" onclick="openModal()">Cerrar sesión</button>
                    </form>
            </div>
        </header>

        <div class="dashboard-content">
            <!-- COLUMNA IZQUIERDA - MÁS GRANDE -->
            <div class="left-column">
    <div class="greeting-card">
        <div class="greeting-text">
        <h2>Hola, {{ usuario.Us_nombre }}!</h2>
                <p>Bienvenido a tu entorno virtual, recuerda estar atento a las notificaciones y trabajos pendientes de tu colegio!</p>
        </div>
        <div class="greeting-illustration">
            <img src="{% static 'images/acudientes/lectura.png' %}" class="greeting-illustration" alt="Perfil">
        </div>
    </div>

                <!-- Sección de Notificaciones -->
                <div class="notifications-section">
    

    <div class="notifications-section">
    <div class="notifications-header">
        <h3>Matrículas recientes</h3>
        <a href="{% url 'crear_matricula' %}" class="ver-todo-btn">Nueva matrícula</a>
    </div>

    <div class="table-wrapper">
        <table class="styled-table">
            <thead>
                <tr>
                    <th>Estudiante</th>
                    <th>Acudiente</th>
                    <th>Fecha</th>
                    <th>Estado</th>
                    <th>Pago</th>
                    <th>Valor</th>
                    <th>Nivel</th>
                </tr>
            </thead>
            <tbody>
                {% if matriculas_recientes %}
                    {% for m in matriculas_recientes %}
                    <tr>
                        <td>{{ m.Estudiantes_Est.Usuario_us.Us_nombre }}</td>
                        <td>{{ m.Estudiantes_Est.Acudiente_set.first.Usuario_us.Us_nombre }}</td>
                        <td>{{ m.Mat_fecha|date:"M d, Y" }}</td>
                        <td>{{ m.Mat_estado }}</td>
                        <td>{{ m.Mat_metodo_pago }}</td>
                        <td>${{ m.Mat_valor|floatformat:0 }}</td>
                        <td>{{ m.Mat_nivel }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="8" style="text-align:center; font-style:italic;">
                            No hay matrículas recientes
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
                </div>
            </div>
            </div>

            <!-- COLUMNA DERECHA -->
            <div class="right-column">
                <div class="calendar-section">
                    <div class="calendar-top">
                        <h4 id="calendar-month-year"></h4>
                        <div class="calendar-nav">
                            <button class="nav-btn prev-btn" onclick="changeMonth(-1)">‹</button>
                            <button class="nav-btn next-btn" onclick="changeMonth(1)">›</button>
                        </div>
                    </div>

                    <div class="calendar-widget">
                        <div class="calendar-grid" id="calendar-grid">
                            <div class="day-header">DO</div>
                            <div class="day-header">LU</div>
                            <div class="day-header">MA</div>
                            <div class="day-header">MI</div>
                            <div class="day-header">JU</div>
                            <div class="day-header">VI</div>
                            <div class="day-header">SA</div>
                        </div>
                    </div>
                </div>

                <!-- Perfil del Estudiante -->
                <div class="acudient-profile">
                    <div class="student-avatar">
                            <a href="{% url 'ver_perfil_directivos' %}">
                        {% if usuario.foto_perfil_usuario %}
                            <img src="{{ usuario.foto_perfil_usuario.url }}" class="user-avatar" alt="Perfil">
                        {% else %}
                            <img src="{% static 'images/acudientes/perfil.png' %}" class="user-avatar" alt="Perfil">
                        {% endif %}
                    </a>
                    </div>
                    <h4 class="acudient-name">{{ usuario.Us_nombre }}</h4>
                    <p class="acudient-role">Directivo</p>

                    <div class="acudient-info">
                        <div class="info-row">
                            <span class="info-label">Estado</span>
                            <span class="info-value">Directivo</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Fecha registro</span>
                            <span class="info-value">{{ usuario.fecha_registro }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Modal logout -->
    <div id="logout-modal" class="modal">
        <div class="modal-content">
            <h2>¿Cerrar Sesión?</h2>
            <div class="modal-actions">
                <form method="POST" action="{% url 'login' %}">
                    {% csrf_token %}
                    <button type="submit" class="btn-confirm">Confirmar</button>
                </form>
                <button class="btn-cancel" onclick="closeModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <script>
    function toggleMenu() {
        const menu = document.getElementById("dropdown-menu");
        menu.classList.toggle("show");
    }
    </script>

    <script>
        const modal = document.getElementById('logout-modal');
        function openModal() { modal.style.display = 'flex'; }
        function closeModal() { modal.style.display = 'none'; }
        window.onclick = function(event) {
            if (event.target == modal) { closeModal(); }
        }
    </script>

    <script>
        let currentDate = new Date();
        function renderCalendar(date) {
            const month = date.getMonth();
            const year = date.getFullYear();
            const monthYear = document.getElementById("calendar-month-year");
            const months = [
                "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
                "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"
            ];
            monthYear.textContent = `${months[month]}, ${year}`;

            const calendarGrid = document.querySelector(".calendar-grid");
            calendarGrid.innerHTML = `
                <div class="day-header">DO</div>
                <div class="day-header">LU</div>
                <div class="day-header">MA</div>
                <div class="day-header">MI</div>
                <div class="day-header">JU</div>
                <div class="day-header">VI</div>
                <div class="day-header">SA</div>
            `;

            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            const prevLastDate = new Date(year, month, 0).getDate();

            for (let i = firstDay - 1; i >= 0; i--) {
                const dayCell = document.createElement("div");
                dayCell.classList.add("day-cell", "prev-month");
                dayCell.textContent = prevLastDate - i;
                calendarGrid.appendChild(dayCell);
            }

            let today = new Date();
            let formatter = new Intl.DateTimeFormat("es-CO", {
                timeZone: "America/Bogota",
                day: "numeric", month: "numeric", year: "numeric"
            });
            let parts = formatter.formatToParts(today);
            let todayDay = parseInt(parts.find(p => p.type === "day").value);
            let todayMonth = parseInt(parts.find(p => p.type === "month").value) - 1;
            let todayYear = parseInt(parts.find(p => p.type === "year").value);

            for (let i = 1; i <= lastDate; i++) {
                const dayCell = document.createElement("div");
                dayCell.classList.add("day-cell");
                dayCell.textContent = i;
                if (year === todayYear && month === todayMonth && i === todayDay) {
                    dayCell.classList.add("current-day");
                }
                calendarGrid.appendChild(dayCell);
            }
        }
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            renderCalendar(currentDate);
        }
        renderCalendar(currentDate);
    </script>

</body>
</html>