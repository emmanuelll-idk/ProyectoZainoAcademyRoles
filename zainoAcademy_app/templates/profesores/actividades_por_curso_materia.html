{% extends "profesores/base.html" %}
{% load entregas_extras %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/profesores/actividades_por_curso_materia.css' %}">
{% endblock %}

{% block mockUp %}
<div class="content">
    <h2 class="section-title">
        Curso: {{ curso.Cur_nombre }} | Materia: {{ materia.Mtr_nombre }}
    </h2>

    <form method="post" action="{% url 'guardar_calificaciones' bol_id=curso.Cur_id %}">
        {% csrf_token %}
        <table class="calificaciones-table">
            <thead>
                <tr>
                    <th>Nombre Estudiante</th>
                    {% for actividad in actividades %}
                        <th>{{ actividad.Act_nombre }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for estudiante in estudiantes %}
                <tr>
                    <td>{{ estudiante }}</td>
                    {% for actividad in actividades %}
                        {% get_entrega entregas estudiante.Est_id actividad.Act_id as entrega %}
                        <td>
                            {% if entrega %}
                                <div class="entrega-info">
                                    <p><strong>Archivo:</strong> 
                                        <a href="{{ entrega.Ent_archivo.url }}" target="_blank">Ver</a>
                                    </p>
                                    <p><strong>Fecha límite:</strong> {{ actividad.Act_fechaLimite|date:"d/m/Y" }}</p>
                                    <input type="number" step="0.1" name="calificacion_{{ entrega.id }}" 
                                           value="{{ entrega.Ent_calificacion|default:'' }}" 
                                           placeholder="Calificación" min="0" max="10" class="calificacion-input">
                                    <input type="text" name="comentario_{{ entrega.id }}" 
                                           value="{{ entrega.Ent_comentario|default:'' }}" 
                                           placeholder="Comentario" class="comentario-input">
                                </div>
                            {% else %}
                                <p class="no-entrega">Sin entrega</p>
                            {% endif %}
                        </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="acciones">
            <a href="{% url 'actividad_profesores_consultar_cursos' periodo_id %}" class="btn-volver">Volver</a>
            <button type="submit" class="btn-guardar">Guardar</button>
        </div>
    </form>
</div>
{% endblock %}